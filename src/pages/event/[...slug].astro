---
import Layout from '../../layouts/Layout.astro';
import StoryblokComponent from "@storyblok/astro/StoryblokComponent.astro";
import { fetchEvents, fetchStoryByPath } from "../../lib/storyblok-fetch";

export async function getStaticPaths() {
  const allEvents = await fetchEvents();

  return allEvents.map((event: any) => {
    return {
      params: {
        slug: event.slug,
      },
    };
  });
}

const { slug } = Astro.params;

const event = await fetchStoryByPath(`main-site/event/${slug}`);
---

<Layout title={`${event.name}`} pill="Event" image={`${event.content.headerImage && event.content.headerImage.filename}`}>
  <StoryblokComponent name={event.name} blok={event.content} tags={event.tag_list} />
</Layout>
