---
import { storyblokEditable } from '@storyblok/astro';
import { richTextResolver } from '@storyblok/richtext'
import RichText from '../RichText.astro';

export interface Props {
  blok: {
    images: [];
  };
}

const { render } = richTextResolver()

const { blok } = Astro.props
---

<div {...storyblokEditable(blok)} class="swiper carousel-slider">
  <div class="swiper-wrapper">
    {blok.images.map((image: any) => (
      <div class="swiper-slide">
        <img src={image.imageURL.filename} />
        {image.caption.content[0].content && (
           <figcaption class="carousel-caption d-none d-md-block">
            <RichText blok={{ body: image.caption }} />
           </figcaption>
        )}
      </div>
    ))}
  </div>

  <div class="container">
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
    <div class="swiper-pagination"></div>
  </div>
</div>

<style>
      .swiper {

      }
      .swiper-slide {
      
      text-align: center;
      font-size: 18px;
      background: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 450px;
      margin: 30px 0;
      
    }

    .swiper-slide img {
      height: 100%;
      object-fit: contain;
    }

    .carousel-caption {
      background-color: rgba(250,250,250,0.7);
      right: 15%;
      bottom: 0.5rem;
      left: 15%;
      padding-top: 0;
      padding-bottom: 0;
      color: #fff;
      text-align: center;
    }

    figcaption, p {
      font-weight: 100;
      font-size: 0.6rem;
      margin: 0;
    }

    .swiper-button-prev, .swiper-button-next {
      color: rgba(255,255,255,0.5);
    }
</style>
<script>
  import Swiper from 'swiper';
  import { Navigation, Pagination } from 'swiper/modules';

  new Swiper('.carousel-slider', {
    modules: [Navigation, Pagination],
    pagination: {
      el: '.swiper-pagination',
      type: 'fraction',
    },
    loop: true,
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
  });
</script>